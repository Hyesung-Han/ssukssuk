<!-- /server/sql/community.xml -->

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="COMMUNITY">  

  <select id="COMMUNITY.SELECT.list">
  	/* 글 목록 조회 */
    SELECT  
        community_no,
        community_title,
        community_author,
        community_date,
        community_hit,
        community_code,
        community_user_id
    FROM community_T
      <if test="type != undefined"> where community_code = #{type}</if>
    order by community_no desc;
  </select>

  <insert id="COMMUNITY.INSERT.regi">
  	/* 글 작성 */
    INSERT INTO community_T
    (
        community_title,
        community_author,
        community_date,
        community_content,
        community_code,
        community_user_id
    )
    VALUES
    (
        #{title}, 
        #{author}, 
        now(),
        #{content},
        #{code},
        #{user_id}
    )
  </insert>

  <update id = "COMMUNITY.UPDATE.updateArticle ">
    /* 글 업데이트 */
      update community_T set
      community_title = #{title},
      community_content = #{content}
      where community_no = #{no}
  </update>

  <select id="COMMUNITY.SELECT.Detail">
  	/* 글 상세 조회 */
    SELECT  
        community_no,
        community_title,
        community_author,
        community_content,
        community_date,
        community_hit,
        community_code,
        community_user_id
    FROM community_T
    where community_no = #{no};
  </select>

  <delete id="COMMUNITY.DELETE.article">
    /* 글정보 삭제 */
    Delete
    From community_T
    Where community_no = #{no}      
  </delete>

  <select id="COMMUNITY.SELECT.search">
  	/* 글 목록 검색 */
    SELECT  
        community_no,
        community_title,
        community_author,
        community_date,
        community_hit,
        community_code,
        community_user_id
    FROM community_T
      <if test="keyword != undefined"> where community_title like CONCAT('%',#{keyword},'%') 
      OR community_content like CONCAT('%',#{keyword},'%')</if>
    order by community_no desc;
  </select>

</mapper>